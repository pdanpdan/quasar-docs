(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[86],{"1f2e":function(e,t,n){"use strict";n.r(t);var s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("doc-page",{attrs:{"meta-title":e.metaTitle,title:"BEX Communication",nav:e.nav,toc:e.toc,"meta-desc":e.metaDesc}},[n("p",[e._v("Allowing a Quasar App to communicate with the various parts of the BEX is essential. Quasar closes this gap using a "),n("code",{staticClass:"doc-token"},[e._v("bridge")]),e._v(".")]),n("p",[e._v("There are 4 areas in a BEX which will need a communication layer:")]),n("ol",[n("li",[e._v("The Quasar App itself - this is true for all types of BEX i.e Popup, Options Page, Dev Tools or Web Page")]),n("li",[e._v("Background Script")]),n("li",[e._v("Content Script")]),n("li",[e._v("The web page that the BEX is running on")])]),n("h2",{staticClass:"doc-heading doc-h2",attrs:{id:"communication-rules"},on:{click:function(t){return e.copyHeading("communication-rules")}}},[e._v("Communication Rules")]),n("p",[e._v("There is a fundamental rule to understand with the communication bridge in Quasar.")]),n("p",[n("strong",[e._v("Not all BEX types have a content script")]),e._v(" - Only BEX which run in the context of a web page will have a content script. This is how browser extensions in general work. This means if you’re adding a listener for an event on a content script and trying to trigger it from a Quasar BEX running as Dev Tools, Options Page or Popup - "),n("strong",[e._v("it won’t work")]),e._v(".")]),n("p",[e._v("If you want to allow your Dev Tools, Popup or Options Page BEX to communicate with a web page, you will need to use the background script as a proxy. You would do this by:")]),n("ol",[n("li",[e._v("Adding a listener on the background script which in turn emits another event.")]),n("li",[e._v("Add a listener to your Quasar App running in the Web Page context which listens for the event the background script is\nraising")]),n("li",[e._v("Emitting the event to your background script from your Dev Tools, Popup or Options Page.")])]),n("p",[e._v("Once you get your head around this concept, there are no limits to how the BEX can communicate with each part.")]),n("h2",{staticClass:"doc-heading doc-h2",attrs:{id:"the-bridge"},on:{click:function(t){return e.copyHeading("the-bridge")}}},[e._v("The Bridge")]),n("p",[e._v("The bridge is a promise based event system which is shared between all parts of the BEX and as such allows you to listen for events in your Quasar App, emit them from other parts or vice versa. This is what gives Quasar BEX mode it’s power.")]),n("p",[e._v("To access the bridge from within your Quasar App you can use "),n("code",{staticClass:"doc-token"},[e._v("this.$q.bex")]),e._v(". In other areas, the bridge is made available via the "),n("code",{staticClass:"doc-token"},[e._v("bridge")]),e._v(" parameter in the respective hook files.")]),n("p",[e._v("Let’s see how it works.")]),n("h3",{staticClass:"doc-heading doc-h3",attrs:{id:"trigger-an-event-and-wait-for-the-response"},on:{click:function(t){return e.copyHeading("trigger-an-event-and-wait-for-the-response")}}},[e._v("Trigger an event and wait for the response")]),n("pre",{pre:!0,attrs:{class:"doc-code language-js"}},[n("code",{pre:!0,attrs:{class:"doc-code__inner doc-code__inner--prerendered language-js"}},[e._v("bridge"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[e._v("send")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[e._v("'some.event'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[e._v("someKey")]),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[e._v("'aValue'")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[e._v("then")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[e._v("response")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=>")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n  console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[e._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[e._v("'Some response from the other side'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n")])]),n("h3",{staticClass:"doc-heading doc-h3",attrs:{id:"listen-for-an-event-and-sending-a-response"},on:{click:function(t){return e.copyHeading("listen-for-an-event-and-sending-a-response")}}},[e._v("Listen for an event and sending a response")]),n("pre",{pre:!0,attrs:{class:"doc-code language-js"}},[n("code",{pre:!0,attrs:{class:"doc-code__inner doc-code__inner--prerendered language-js"}},[e._v("bridge"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[e._v("on")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[e._v("'some.event'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token parameter"}},[e._v("event")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=>")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n  console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[e._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[e._v("'Event Receieved, responding ...'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n  bridge"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[e._v("send")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("event"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("eventResponseKey"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n")])]),n("h3",{staticClass:"doc-heading doc-h3",attrs:{id:"clean-up-your-listeners"},on:{click:function(t){return e.copyHeading("clean-up-your-listeners")}}},[e._v("Clean up your listeners")]),n("pre",{pre:!0,attrs:{class:"doc-code language-js"}},[n("code",{pre:!0,attrs:{class:"doc-code__inner doc-code__inner--prerendered language-js"}},[e._v("bridge"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[e._v("off")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[e._v("'some.event'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("someFunction"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n")])]),n("p",[e._v("Wait, what’s "),n("code",{staticClass:"doc-token"},[e._v("bridge.send(event.eventResponseKey)")]),e._v("?")]),n("p",[e._v("The Quasar bridge does some work behind the scenes to convert the normal event based communication into promises and as such, in order for the promise to resolve, we need to send a "),n("em",[e._v("new")]),e._v(" event which is captured and promisified.")]),n("div",{staticClass:"doc-note doc-note--warning"},[n("p",{staticClass:"doc-note__title"},[e._v("WARNING")]),n("p",[e._v("If you omit "),n("code",{staticClass:"doc-token"},[e._v("bridge.send(event.eventResponseKey)")]),e._v(" the promise on "),n("code",{staticClass:"doc-token"},[e._v(".send()")]),e._v(" will not resolve.")])]),n("div",{staticClass:"doc-note doc-note--tip"},[n("p",{staticClass:"doc-note__title"},[e._v("TIP")]),n("p",[e._v("The bridge also does some work to split large data which is too big to be transmitted in one go due to the browser extension 60mb data transfer limit. In order for this to happen, the payload must be an array.")])])])},a=[],o=n("8669"),r={name:"DocMarkdownPage",created:function(){this.metaTitle="BEX Communication",this.metaDesc="How to communicate between different parts of your Browser Extension (BEX) in Quasar.",this.nav=[{name:"Types of BEX",category:"Developing Browser Extensions",path:"/quasar-cli/developing-browser-extensions/types-of-bex",dir:"left"},{name:"Background Hooks",category:"Developing Browser Extensions",path:"/quasar-cli/developing-browser-extensions/background-hooks",dir:"right"}],this.toc=[{id:"communication-rules",title:"Communication Rules"},{id:"the-bridge",title:"The Bridge"},{id:"trigger-an-event-and-wait-for-the-response",title:"Trigger an event and wait for the response",sub:!0},{id:"listen-for-an-event-and-sending-a-response",title:"Listen for an event and sending a response",sub:!0},{id:"clean-up-your-listeners",title:"Clean up your listeners",sub:!0}],this.copyHeading=o["a"]}},i=r,c=n("2877"),p=Object(c["a"])(i,s,a,!1,null,null,null);t["default"]=p.exports}}]);